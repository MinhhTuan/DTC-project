extend ./layouts/main-layout.pug
block content
  .container
    .banner 
      img(src="images/car-machine-2.jpg", alt="car")
    .query__area
      .query__left
        .brand
          select#brandList.select__box
            if brands.length  > 0
              each brand in brands 
                option(value=brand.id) #{brand.brand_name}
            
            option(selected='selected' value='0') --Ch&#x1ECD;n h&atilde;ng xe--
        .model
          select#modelList.select__box(name='model_id')
            option(selected='selected' value='0') --Ch&#x1ECD;n d&ograve;ng xe--
      .query__right 
        .year
          select#yearList.select__box
            if years.length  > 0
              each year in years 
                option(value=year) #{year}
            option(selected='selected' value='0') --Ch&#x1ECD;n n&abreve;m s&#x1EA3;n xu&#x1EA5;t--
        .error__code
          input(type='text' name='error_code' placeholder='Nhập mã lỗi')
    button#btnSubmit.btn Tra cứu              
      i.fa-solid.fa-magnifying-glass
    .output__area

    #about.about__section 
      h2.about__title About us 
      .user__list
        .user__card
          img.avatar(src="https://loremflickr.com/320/240" alt="avatar")
          h5.name Lorem Alan
          span.description Lorem ipsum dolor, sit amet consectetur adipisicing elit. Maxime voluptatum possimus nam porro. Dolor laudantium dolores deleniti ut nulla, sequi cumque recusandae aliquam blanditiis labore reprehenderit placeat aperiam, a obcaecati.
          .media 
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-facebook
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-instagram
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-telegram
        .user__card
          img.avatar(src="https://loremflickr.com/320/240" alt="avatar")
          h5.name Lorem Alan
          span.description Lorem ipsum dolor, sit amet consectetur adipisicing elit. Maxime voluptatum possimus nam porro. Dolor laudantium dolores deleniti ut nulla, sequi cumque recusandae aliquam blanditiis labore reprehenderit placeat aperiam, a obcaecati.
          .media 
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-facebook
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-instagram
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-telegram
        .user__card
          img.avatar(src="https://loremflickr.com/320/240" alt="avatar")
          h5.name Lorem Alan
          span.description Lorem ipsum dolor, sit amet consectetur adipisicing elit. Maxime voluptatum possimus nam porro. Dolor laudantium dolores deleniti ut nulla, sequi cumque recusandae aliquam blanditiis labore reprehenderit placeat aperiam, a obcaecati.
          .media 
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-facebook
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-instagram
            a.icon(href="#" target="_blank" rel="noopener") 
              i.fa-brands.fa-telegram


    script.
      $("#brandList").on("change", function () {
          let brand = $(this).val();
          
          $.get( "/models/" + brand, function( data ) {
            $("#modelList").empty();
            $('#modelList').append($('<option>', {
                value: 0,
                text: "--Chọn dòng xe--"
            }));
            $.each(data, function( index, obj) {
              $('#modelList').append($('<option>', {
                  value: obj.id,
                  text: obj.model_name
              }));
            });
          });
      });

      $("#btnSubmit").on("click", function(){
        const data = {
          "error_code": $('input[name=error_code]').val(),
          "model_id": $('#modelList').val()
        }
        $.get( "result/" , data).done(function( data ) {
          console.log( data );
          $(".output__area").empty();
          $('.output__area').append($('<iframe>', {
            src: data.solution.replace("view", "preview"),
            width: '100%',
            height: '100%',
            allow: 'autoplay'
          }));
        });
      })
    
  //- script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js' integrity='sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2' crossorigin='anonymous')
